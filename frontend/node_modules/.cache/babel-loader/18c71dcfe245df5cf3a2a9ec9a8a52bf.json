{"ast":null,"code":"var _jsxFileName = \"/home/guys/Documents/shifts-ui/src/components/page-management/Tab1/Tab1-construction.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport useWindowDimensions from '../../general/useWindowDimensions';\nimport Table from '../constraction-table/Table';\nimport ShowConstraintOf from './ShowContraintOf';\nimport NoBakarimDBAlert from './Alerts/Alert-NoBakarimDB';\nimport NoShiftsAlert from './Alerts/Alert-NoShifts';\nimport NoSubmitAlert from './Alerts/Alert-NoSubmit';\nimport _88Alert from './Alerts/Alert-8-8s';\nimport SuccessModal from './Modal';\nimport ChooseWeek from '../../general/chooseWeek.js';\nimport { Container, Col, Form, Jumbotron, Button, Spinner } from 'react-bootstrap';\nimport { getWeek } from '../../../scripts';\n\nfunction App(props) {\n  const {\n    windowWidth\n  } = useWindowDimensions();\n  const minWindowSize = 1420.69;\n  const form = useRef(null);\n  const [data, setData] = useState([]);\n  const [isLoaded, setLoaded] = useState(false);\n  const [ignore, setIgnore] = useState(false);\n  const [week, setWeek] = useState(null);\n  const [showAlert2, setShowAlert2] = useState(false);\n  const [showAlert3, setShowAlert3] = useState(false);\n  const [empConstraints, setEmpConstraints] = useState({});\n  const [remain_bakarim, setRB] = useState([]);\n  useEffect(() => {\n    if (week == null) return;\n    setLoaded(false);\n    fetch(\"/weekconstraints?week=\" + week, {\n      method: 'GET'\n    }).then(res => res.json()).then(result => {\n      let data = result['week_constraints'];\n      setData(data);\n      let submitted = data.map(val => val.name);\n      let remain = [...props.bakarim.map(value => value.full_name).filter(x => !submitted.includes(x))];\n      setRB(remain.map(val => /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 37\n        }\n      }, val)));\n      let constraints = {};\n      data.map(cons => constraints[cons.name] = {\n        'name': cons.name,\n        'shifts': cons.shifts,\n        'comments': cons.comments\n      });\n      setEmpConstraints(constraints);\n      setConsJumbo( /*#__PURE__*/React.createElement(ShowConstraintOf, {\n        week: week,\n        items: constraints,\n        bakarim: props.bakarim,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 26\n        }\n      }));\n      setLoaded(true);\n    }).catch(error => {\n      alert(\"tab1 error: \" + error);\n      setLoaded(true);\n    });\n  }, [week]);\n  useEffect(() => {\n    if (props.bakarim.length !== 0) {\n      setShowAlert3(false);\n      setWeek(getWeek(1));\n    } else {\n      const timer = setTimeout(() => {\n        setShowAlert3(true);\n        setLoaded(true);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [props.bakarim]);\n  const [consJumbo, setConsJumbo] = useState();\n\n  const handleChangeWeek = e => {\n    setShowAlert2(false);\n    setWeek(e.target.value);\n    setConsJumbo( /*#__PURE__*/React.createElement(ShowConstraintOf, {\n      week: e.target.value,\n      items: empConstraints,\n      bakarim: props.bakarim,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 22\n      }\n    }));\n  };\n\n  const [_88count, set88Count] = useState(0);\n  const [isModalShown, setShowModal] = useState(false);\n\n  const hideModal = () => {\n    setShowModal(false);\n    window.location.reload();\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    let data = new FormData(form.current);\n    fetch('/submitschedule', {\n      method: 'POST',\n      body: data\n    }).then(res => res).then(data => setShowModal(true)).catch(error => alert('משהו נדפק, המשמרות לא הוגשו בהצלחה :('));\n  };\n\n  return !isLoaded ? /*#__PURE__*/React.createElement(Spinner, {\n    animation: \"border\",\n    variant: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }) : showAlert3 ? /*#__PURE__*/React.createElement(NoBakarimDBAlert, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(SuccessModal, {\n    show: isModalShown,\n    handleClose: hideModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NoShiftsAlert, {\n    bakarim: remain_bakarim,\n    week: week,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(NoSubmitAlert, {\n    showAlert: showAlert2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(_88Alert, {\n    count: _88count,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Jumbotron, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    ref: form,\n    onSubmit: handleSubmit,\n    method: \"post\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    sm: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 45\n    }\n  }, \"\\u05D4\\u05DB\\u05E0\\u05EA \\u05D4\\u05E1\\u05D9\\u05D3\\u05D5\\u05E8 \\u05DC\\u05E9\\u05D1\\u05D5\\u05E2: \")), /*#__PURE__*/React.createElement(Col, {\n    sm: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(ChooseWeek, {\n    week: week,\n    defaultWeek: 1,\n    onChange: handleChangeWeek,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 45\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Form.Check, {\n    type: \"switch\",\n    label: \"\\u05D4\\u05EA\\u05E2\\u05DC\\u05DD \\u05DE\\u05D0\\u05D9\\u05DC\\u05D5\\u05E6\\u05D9\\u05DD\",\n    id: \"ignore\",\n    checked: ignore,\n    onClick: e => setIgnore(!ignore),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 37\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    sm: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 33\n    }\n  }, windowWidth > minWindowSize ? /*#__PURE__*/React.createElement(Table, {\n    data: data,\n    week: week,\n    bakarim: props.bakarim,\n    dictionary: props.dictionary,\n    setShowAlert2: e => setShowAlert2(e),\n    ignore: ignore,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 41\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 45\n    }\n  }, \"\\u05EA\\u05D2\\u05D3\\u05D9\\u05DC \\u05EA'\\u05D7\\u05DC\\u05D5\\u05DF \\u05D0\\u05D1\\u05D0\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      display: \"none\"\n    },\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 45\n    }\n  }))))), /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 33\n    }\n  }, \"\\u05D4\\u05E2\\u05E8\\u05D5\\u05EA: \"), /*#__PURE__*/React.createElement(Form.Control, {\n    as: \"textarea\",\n    name: \"comments\",\n    rows: \"3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 33\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    variant: \"outline-primary\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 37\n    }\n  }, \"\\u05E9\\u05D2\\u05E8!\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 33\n    }\n  })))))), /*#__PURE__*/React.createElement(Jumbotron, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }\n  }, consJumbo));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/guys/Documents/shifts-ui/src/components/page-management/Tab1/Tab1-construction.js"],"names":["React","useState","useEffect","useRef","useWindowDimensions","Table","ShowConstraintOf","NoBakarimDBAlert","NoShiftsAlert","NoSubmitAlert","_88Alert","SuccessModal","ChooseWeek","Container","Col","Form","Jumbotron","Button","Spinner","getWeek","App","props","windowWidth","minWindowSize","form","data","setData","isLoaded","setLoaded","ignore","setIgnore","week","setWeek","showAlert2","setShowAlert2","showAlert3","setShowAlert3","empConstraints","setEmpConstraints","remain_bakarim","setRB","fetch","method","then","res","json","result","submitted","map","val","name","remain","bakarim","value","full_name","filter","x","includes","constraints","cons","shifts","comments","setConsJumbo","catch","error","alert","length","timer","setTimeout","clearTimeout","consJumbo","handleChangeWeek","e","target","_88count","set88Count","isModalShown","setShowModal","hideModal","window","location","reload","handleSubmit","preventDefault","FormData","current","body","dictionary","display"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useRef } from 'react'\nimport useWindowDimensions from '../../general/useWindowDimensions'\nimport Table from '../constraction-table/Table'\nimport ShowConstraintOf from './ShowContraintOf'\nimport NoBakarimDBAlert from './Alerts/Alert-NoBakarimDB'\nimport NoShiftsAlert from './Alerts/Alert-NoShifts'\nimport NoSubmitAlert from './Alerts/Alert-NoSubmit'\nimport _88Alert from './Alerts/Alert-8-8s'\nimport SuccessModal from './Modal'\nimport ChooseWeek from '../../general/chooseWeek.js'\nimport { Container, Col, Form, Jumbotron, Button, Spinner } from 'react-bootstrap'\nimport { getWeek } from '../../../scripts'\n\nfunction App(props) {\n    const {windowWidth} = useWindowDimensions()\n    const minWindowSize = 1420.69\n    const form = useRef(null)\n    const [data, setData] = useState([])\n    const [isLoaded, setLoaded] = useState(false)\n    const [ignore, setIgnore] = useState(false)\n    const [week, setWeek] = useState(null)\n    const [showAlert2, setShowAlert2] = useState(false)\n    const [showAlert3, setShowAlert3] = useState(false)\n    const [empConstraints, setEmpConstraints] = useState({})\n    const [remain_bakarim, setRB] = useState([]) \n    useEffect(() => {\n        if (week == null) return\n        setLoaded(false)\n        fetch(\"/weekconstraints?week=\"+week, {method: 'GET'})\n        .then(res => res.json())\n        .then((result) => {\n            let data = result['week_constraints']\n            setData(data)\n            let submitted = data.map(val => val.name)\n            let remain = [...props.bakarim.map(value => value.full_name).filter(x => !submitted.includes(x))]\n            setRB(remain.map(val => <li>{val}</li>))\n\n            let constraints = {}\n            data.map(cons => \n                constraints[cons.name] = {\n                    'name': cons.name,\n                    'shifts': cons.shifts,\n                    'comments': cons.comments\n                }\n            )\n            setEmpConstraints(constraints)\n            setConsJumbo(<ShowConstraintOf week={week} items={constraints} bakarim={props.bakarim} />)\n            setLoaded(true)\n        })\n        .catch(error => {\n            alert(\"tab1 error: \" + error)\n            setLoaded(true)\n        })\n    }, [week])\n\n    useEffect(() => {\n        if (props.bakarim.length !== 0) {\n            setShowAlert3(false)\n            setWeek(getWeek(1))\n        }\n        else\n        {\n            const timer = setTimeout(() => {\n                setShowAlert3(true)\n                setLoaded(true)\n            }, 5000)\n            return () => clearTimeout(timer)\n        }\n    }, [props.bakarim])\n\n    const [consJumbo, setConsJumbo] = useState()\n    const handleChangeWeek = (e) => {\n        setShowAlert2(false)\n        setWeek(e.target.value)\n        setConsJumbo(<ShowConstraintOf week={e.target.value} items={empConstraints} bakarim={props.bakarim}/>)\n    }\n\n    const [_88count, set88Count] = useState(0)\n\n    const [isModalShown, setShowModal] = useState(false)\n    const hideModal = () => {\n        setShowModal(false)\n        window.location.reload()\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault()\n        let data = new FormData(form.current)\n        fetch('/submitschedule', {method: 'POST', body: data})\n        .then(res => res)\n        .then(data => setShowModal(true))\n        .catch(error => alert('משהו נדפק, המשמרות לא הוגשו בהצלחה :('))\n    }\n\n    return (\n        !isLoaded ? \n            <Spinner animation=\"border\" variant=\"primary\"/>\n        :\n        showAlert3 ? \n            <NoBakarimDBAlert />\n        :\n        <main>\n            <SuccessModal show={isModalShown} handleClose={hideModal} />\n            <NoShiftsAlert bakarim={remain_bakarim} week={week}/>\n            <NoSubmitAlert showAlert={showAlert2} />\n            <_88Alert count={_88count} />\n            <Jumbotron>\n                <Container fluid>\n                    <Form ref={form} onSubmit={handleSubmit} method=\"post\">\n                        <Form.Group>\n                            <Form.Row>\n                                <Col sm=\"6\"><h3>הכנת הסידור לשבוע: </h3></Col>        \n                                <Col sm=\"6\"><ChooseWeek week={week} defaultWeek={1} onChange={handleChangeWeek}/></Col>\n                            </Form.Row>\n                            <Form.Row>\n                                    <Form.Check\n                                        type=\"switch\"\n                                        label=\"התעלם מאילוצים\"\n                                        id=\"ignore\"\n                                        checked={ignore}\n                                        onClick={(e) => setIgnore(!ignore)}/>\n                            </Form.Row>\n                        </Form.Group>\n                        <Form.Group>\n                            <Form.Row>\n                                <Col sm=\"12\">\n                                    {(windowWidth > minWindowSize) ?\n                                        <Table\n                                            data={data}\n                                            week={week}\n                                            bakarim={props.bakarim}\n                                            dictionary={props.dictionary}\n                                            setShowAlert2={(e) => setShowAlert2(e)}\n                                            ignore={ignore}\n                                            />\n                                    :\n                                        <>\n                                            <h2>תגדיל ת'חלון אבא</h2>\n                                            <input style={{display: \"none\"}} required/>\n                                        </>\n                                    }\n                                </Col>\n                            </Form.Row>\n                        </Form.Group>\n                        <Form.Group>\n                            <Form.Row>\n                                <Form.Label>הערות: </Form.Label>\n                                <Form.Control as='textarea' name='comments' rows=\"3\" />\n                            </Form.Row>\n                        </Form.Group>\n                        <Form.Group>\n                            <Form.Row>\n                                <Col />\n                                    <Button variant=\"outline-primary\" type=\"submit\">שגר!</Button>\n                                <Col />\n                            </Form.Row>\n                        </Form.Group>\n                    </Form>\n                </Container>\n            </Jumbotron>\n            <Jumbotron>\n                {consJumbo}\n            </Jumbotron>\n        </main>\n    );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}